<style>
  div {
    text-align: justify;
    text-justify: inter-word;
  }
  </style>
<%- include('./../common/navbar')%>
  <div class="main-content" id="panel">
    <%- include('./../common/header')%>
      <div class="header bg-primary pb-6">
        <div class="container-fluid">
          <div class="header-body">
            <%- include('./../common/location') %>
          </div>
        </div>
      </div>
      <div class="container-fluid mt--6">
        <!-- Page content -->
        <div class="row">
          <div class="col-xl-4 order-xl-2">
            <div class="card">
              <div class="card-header">
                <div class="row align-items-center">
                  <div class="col-12">
                    <h3 class="mb-0">Applied Candidate</h3>
                  </div>
                  <!-- <div class="col-8 text-right">
                          <a href="#" class="btn btn-primary btn-sm">
                            <i class="fa fa-plus"></i> Schedule Interview
                          </a>
                        </div> -->
                </div>
              </div>
              <div class="card card-stats">
                <!-- Card body -->
                <div id="timelineCards"></div>

              </div>
            </div>
          </div>
          <div class="col-xl-8 order-xl-1">
            <div class="card">
              <div class="card-header">
                <div class="row align-items-center">
                  <div class="col-8">
                    <h3 class="mb-0">Job Description
                      <!-- <a href="#" class="text-warning">
                        <small>( <i class="fa fa-paperclip"></i> View Attached CV)</small>
                      </a> -->
                    </h3>
                  </div>
                  <!-- <div class="col-4 text-right">
                    <div id="status"></div>
                  </div> -->
                </div>
                <!-- <div class="row align-items-center">
                  <div id="acceptRejectBtns" class="col-12 text-right">
                    <a href="#" onclick="select()" class="btn btn-sm btn-success">
                      <i class="fa fa-check"></i> Select
                    </a>
                    <a href="#" onclick="reject()" class="btn btn-sm btn-danger">
                      <i class="fa fa-times"></i> Reject
                    </a>
                  </div>
                </div> -->
              </div>
              <div class="card-body">
                <!-- <div id="hrComment" class="alert alert-default" role="alert">
                  <span class="alert-icon"><i class="fa fa-bullhorn"></i></span>
                  <span class="alert-text"><strong>HR Feedback!</strong> <span id="comment"></span></span>
                </div> -->
                <form>
                  <h6 class="heading-small text-muted mb-4">JOB INFORMATION</h6>
                  <div class="pl-lg-4">
                    <div class="row">
                      <div class="col-lg-12">
                        <div class="form-group">
                          <label class="form-control-label" for="input-username">Opening Name</label>
                          <label id="openingname" class="form-control">{{OPENING NAME}}<label>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-lg-4">
                        <div class="form-group">
                          <label class="form-control-label" for="category">Department</label>
                          <label id="department" class="form-control">{{DEPARTMENT}}<label>
                        </div>
                      </div>
                      <div class="col-lg-4">
                        <div class="form-group">
                          <label class="form-control-label" for="experience">Location</label>
                          <label id="location" class="form-control">{{LOCATION}}<label>
                        </div>
                      </div>
                      <div class="col-lg-8">
                        <div class="form-group">
                          <label class="form-control-label" for="noticePeriod">Status</label>
                          <div class="row">
                            <div class="col-md-6">
                              <label id="status" class="form-control">{{STATUS}}<label>
                            </div>
                            <div class="col-md-6">
                              <button class="btn btn-danger btn-md" id="button" type="button"
                                onclick="activeInactive()">Button</button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-lg-12">
                        <div class="form-group">
                          <label class="form-control-label" for="appliedFor">Job Description</label>
                          <p id="jobdescription">{{JOB DESCRIPTION}}</p>
                        </div>
                      </div>
                      <div class="col-lg-12">
                        <div class="form-group">
                          <label class="form-control-label" for="appliedOn">Skills Required</label>
                          <p id="skillsRequired">{{Skills Required}}</p>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-lg-12">
                        <div class="form-group">
                          <label class="form-control-label">Responsibilities</label>
                          <p id="responsibilities"></p>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- <div class="pl-lg-4">
                    <div class="form-group">
                      <label class="form-control-label">Skills</label>
                      <textarea rows="4" class="form-control" id="skills" readonly
                        placeholder="My skills ..."></textarea>
                    </div>
                  </div>
                  <hr class="my-4" />
                   Address 
                  <h6 class="heading-small text-muted mb-4">Contact informations</h6>
                  <div class="pl-lg-4">
                    <div class="row">
                      <div class="col-lg-6">
                        <div class="form-group">
                          <label class="form-control-label" for="email">Email Id</label>
                          <label id="email" class="form-control">{{EMAIL}}<label>
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="form-group">
                          <label class="form-control-label" for="mobile">Mobile</label>
                          <label id="mobile" class="form-control">{{MOBILE}}<label>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-lg-6">
                        <div class="form-group">
                          <label class="form-control-label" for="country">Country</label>
                          <label id="country" class="form-control">{{COUNTRY}}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <hr class="my-4" />
                   Description 
                  <h6 class="heading-small text-muted mb-4">Other informations</h6>
                  <div class="pl-lg-4">
                    <div class="row">
                      <div class="col-lg-6">
                        <div class="form-group">
                          <label class="form-control-label" for="referrerEmployeeID">Referrer</label>
                          <label id="referrerEmployeeID" class="form-control">{{REFERRER}}<label>
                        </div>
                      </div>
                    </div>
                  </div> -->
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
  </div>
  <%- include('../applications/detailsModal')%>
    <input type="hidden" name="" id="profileid" value="<%=profileId%>">

    <script>
      var token = '';
      var id = ''
      $(() => {
        token = window.localStorage.getItem('token');
        id = $("#profileid").val() || '';
        fetchCandidateProfile();
        fetchCandidateTimeline();
      });
      function fetchCandidateProfile() {
        $.ajax({
          type: "GET",
          url: "/openings/api/v1/openings/" + id,
          beforeSend: function (xhr) {
            xhr.setRequestHeader("Authorization", "Bearer " + token);
          },
          success: function success(result) {
            result = result.data;
            $("#openingname").text(result.openingName);
            $("#responsibilities").text(result.responsibilities);
            $("#location").text(result.location);
            if (result.isActive == 1) {
              $("#status").text("ACTIVE");
              $("#button").text("INACTIVE");
            }
            else {
              $("#status").text("INACTIVE");
              $("#button").text("ACTIVE");
            }
            $("#department").text(result.department);
            $("#jobdescription").text(result.description);
            $("#skillsRequired").text(result.skillsRequired);
          },
          error: function error(error) {
            errorNotification(error.responseJSON.message);
          }
        })
      }

      function fetchCandidateTimeline() {
        $("#timelineCards").html('');
        $.ajax({
          type: "GET",
          url: "/openings/api/v1/openingstimeline/" + id,
          beforeSend: function (xhr) {
            xhr.setRequestHeader("Authorization", "Bearer " + token);
          },
          success: function success(result) {

            result = result.data;
            var cards='';
            var timeline = '';
            result.map((i) => {
              timeline += '<div class="card-body"><div class="row"><div class="col"><h5 class="card-title text-uppercase text-muted mb-0">' + '</h5> <span class="h2 font-weight-bold mb-0"><a href="/applications/applicants/profile/' + i.applicantID +'">' + i.name + '</a></span></div></div><p class="mt-3 mb-0 text-sm"> ' + i.status + '<br><span class="text-nowrap">' + ' <small>' + i.appliedFor + '<br>' + moment(i.createdAt).format('DD/MM/YYYY') + '</small></span></p></div>';
            });
            $("#timelineCards").html(timeline);
          },
          error: function error(error) {
            errorNotification(error.responseJSON.message);
          }
        })
      }
      function activeInactive() {
        if ($("#status").text() == "ACTIVE") {                      
          $("#button").text("ACTIVE");
        }
        else if ($("#status").text() == "INACTIVE") {
          $("#status").text("ACTIVE");
          $("#button").text("INACTIVE");
        }
      }
    </script>